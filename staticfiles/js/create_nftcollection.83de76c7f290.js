const bytecode = "6080604052620f42406008553480156200001857600080fd5b50604051620037353803806200373583398181016040528101906200003e919062000659565b8181816000908162000051919062000929565b50806001908162000063919062000929565b50505062000090604051806080016040528060438152602001620036f2604391396200009860201b60201c565b505062000c0f565b600854620000b260076200015060201b62000aaf1760201c565b1115620000f6576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401620000ed9062000a71565b60405180910390fd5b60006200010f60076200015060201b62000aaf1760201c565b90506200012860076200015e60201b62000abd1760201c565b6200013a33826200017460201b60201c565b6200014c8183620003ba60201b60201c565b5050565b600081600001549050919050565b6001816000016000828254019250508190555050565b600073ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff1603620001e6576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401620001dd9062000ae3565b60405180910390fd5b620001f7816200043460201b60201c565b156200023a576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401620002319062000b55565b60405180910390fd5b620002506000838360016200047d60201b60201c565b62000261816200043460201b60201c565b15620002a4576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016200029b9062000b55565b60405180910390fd5b6001600360008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008282540192505081905550816002600083815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550808273ffffffffffffffffffffffffffffffffffffffff16600073ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef60405160405180910390a4620003b66000838360016200048360201b60201c565b5050565b620003cb826200043460201b60201c565b6200040d576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401620004049062000bed565b60405180910390fd5b806006600084815260200190815260200160002090816200042f919062000929565b505050565b60008073ffffffffffffffffffffffffffffffffffffffff166200045e836200048960201b60201c565b73ffffffffffffffffffffffffffffffffffffffff1614159050919050565b50505050565b50505050565b60006002600083815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050919050565b6000604051905090565b600080fd5b600080fd5b600080fd5b600080fd5b6000601f19601f8301169050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b6200052f82620004e4565b810181811067ffffffffffffffff82111715620005515762000550620004f5565b5b80604052505050565b600062000566620004c6565b905062000574828262000524565b919050565b600067ffffffffffffffff821115620005975762000596620004f5565b5b620005a282620004e4565b9050602081019050919050565b60005b83811015620005cf578082015181840152602081019050620005b2565b60008484015250505050565b6000620005f2620005ec8462000579565b6200055a565b905082815260208101848484011115620006115762000610620004df565b5b6200061e848285620005af565b509392505050565b600082601f8301126200063e576200063d620004da565b5b815162000650848260208601620005db565b91505092915050565b60008060408385031215620006735762000672620004d0565b5b600083015167ffffffffffffffff811115620006945762000693620004d5565b5b620006a28582860162000626565b925050602083015167ffffffffffffffff811115620006c657620006c5620004d5565b5b620006d48582860162000626565b9150509250929050565b600081519050919050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b600060028204905060018216806200073157607f821691505b602082108103620007475762000746620006e9565b5b50919050565b60008190508160005260206000209050919050565b60006020601f8301049050919050565b600082821b905092915050565b600060088302620007b17fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff8262000772565b620007bd868362000772565b95508019841693508086168417925050509392505050565b6000819050919050565b6000819050919050565b60006200080a62000804620007fe84620007d5565b620007df565b620007d5565b9050919050565b6000819050919050565b6200082683620007e9565b6200083e620008358262000811565b8484546200077f565b825550505050565b600090565b6200085562000846565b620008628184846200081b565b505050565b5b818110156200088a576200087e6000826200084b565b60018101905062000868565b5050565b601f821115620008d957620008a3816200074d565b620008ae8462000762565b81016020851015620008be578190505b620008d6620008cd8562000762565b83018262000867565b50505b505050565b600082821c905092915050565b6000620008fe60001984600802620008de565b1980831691505092915050565b6000620009198383620008eb565b9150826002028217905092915050565b6200093482620006de565b67ffffffffffffffff81111562000950576200094f620004f5565b5b6200095c825462000718565b620009698282856200088e565b600060209050601f831160018114620009a157600084156200098c578287015190505b6200099885826200090b565b86555062000a08565b601f198416620009b1866200074d565b60005b82811015620009db57848901518255600182019150602085019450602081019050620009b4565b86831015620009fb5784890151620009f7601f891682620008eb565b8355505b6001600288020188555050505b505050505050565b600082825260208201905092915050565b7f4d6178204e4654206d696e74696e67206c696d69742072656163686564202121600082015250565b600062000a5960208362000a10565b915062000a668262000a21565b602082019050919050565b6000602082019050818103600083015262000a8c8162000a4a565b9050919050565b7f4552433732313a206d696e7420746f20746865207a65726f2061646472657373600082015250565b600062000acb60208362000a10565b915062000ad88262000a93565b602082019050919050565b6000602082019050818103600083015262000afe8162000abc565b9050919050565b7f4552433732313a20746f6b656e20616c7265616479206d696e74656400000000600082015250565b600062000b3d601c8362000a10565b915062000b4a8262000b05565b602082019050919050565b6000602082019050818103600083015262000b708162000b2e565b9050919050565b7f45524337323155524953746f726167653a2055524920736574206f66206e6f6e60008201527f6578697374656e7420746f6b656e000000000000000000000000000000000000602082015250565b600062000bd5602e8362000a10565b915062000be28262000b77565b604082019050919050565b6000602082019050818103600083015262000c088162000bc6565b9050919050565b612ad38062000c1f6000396000f3fe608060405234801561001057600080fd5b50600436106100ea5760003560e01c806370a082311161008c578063b88d4fde11610066578063b88d4fde1461025b578063c87b56dd14610277578063e985e9c5146102a7578063fb37e883146102d7576100ea565b806370a08231146101f157806395d89b4114610221578063a22cb4651461023f576100ea565b8063095ea7b3116100c8578063095ea7b31461016d57806323b872dd1461018957806342842e0e146101a55780636352211e146101c1576100ea565b806301ffc9a7146100ef57806306fdde031461011f578063081812fc1461013d575b600080fd5b61010960048036038101906101049190611969565b6102f3565b60405161011691906119b1565b60405180910390f35b6101276103d5565b6040516101349190611a5c565b60405180910390f35b61015760048036038101906101529190611ab4565b610467565b6040516101649190611b22565b60405180910390f35b61018760048036038101906101829190611b69565b6104ad565b005b6101a3600480360381019061019e9190611ba9565b6105c4565b005b6101bf60048036038101906101ba9190611ba9565b610624565b005b6101db60048036038101906101d69190611ab4565b610644565b6040516101e89190611b22565b60405180910390f35b61020b60048036038101906102069190611bfc565b6106ca565b6040516102189190611c38565b60405180910390f35b610229610781565b6040516102369190611a5c565b60405180910390f35b61025960048036038101906102549190611c7f565b610813565b005b61027560048036038101906102709190611df4565b610829565b005b610291600480360381019061028c9190611ab4565b61088b565b60405161029e9190611a5c565b60405180910390f35b6102c160048036038101906102bc9190611e77565b61099d565b6040516102ce91906119b1565b60405180910390f35b6102f160048036038101906102ec9190611f58565b610a31565b005b60007f80ac58cd000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff191614806103be57507f5b5e139f000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916145b806103ce57506103cd82610ad3565b5b9050919050565b6060600080546103e490611fd0565b80601f016020809104026020016040519081016040528092919081815260200182805461041090611fd0565b801561045d5780601f106104325761010080835404028352916020019161045d565b820191906000526020600020905b81548152906001019060200180831161044057829003601f168201915b5050505050905090565b600061047282610b3d565b6004600083815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050919050565b60006104b882610644565b90508073ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff1603610528576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161051f90612073565b60405180910390fd5b8073ffffffffffffffffffffffffffffffffffffffff16610547610b88565b73ffffffffffffffffffffffffffffffffffffffff161480610576575061057581610570610b88565b61099d565b5b6105b5576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016105ac90612105565b60405180910390fd5b6105bf8383610b90565b505050565b6105d56105cf610b88565b82610c49565b610614576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161060b90612197565b60405180910390fd5b61061f838383610cde565b505050565b61063f83838360405180602001604052806000815250610829565b505050565b60008061065083610fd7565b9050600073ffffffffffffffffffffffffffffffffffffffff168173ffffffffffffffffffffffffffffffffffffffff16036106c1576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016106b890612203565b60405180910390fd5b80915050919050565b60008073ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff160361073a576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161073190612295565b60405180910390fd5b600360008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020549050919050565b60606001805461079090611fd0565b80601f01602080910402602001604051908101604052809291908181526020018280546107bc90611fd0565b80156108095780601f106107de57610100808354040283529160200191610809565b820191906000526020600020905b8154815290600101906020018083116107ec57829003601f168201915b5050505050905090565b61082561081e610b88565b8383611014565b5050565b61083a610834610b88565b83610c49565b610879576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161087090612197565b60405180910390fd5b61088584848484611180565b50505050565b606061089682610b3d565b60006006600084815260200190815260200160002080546108b690611fd0565b80601f01602080910402602001604051908101604052809291908181526020018280546108e290611fd0565b801561092f5780601f106109045761010080835404028352916020019161092f565b820191906000526020600020905b81548152906001019060200180831161091257829003601f168201915b5050505050905060006109406111dc565b90506000815103610955578192505050610998565b60008251111561098a5780826040516020016109729291906122f1565b60405160208183030381529060405292505050610998565b610993846111f3565b925050505b919050565b6000600560008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060009054906101000a900460ff16905092915050565b600854610a3e6007610aaf565b1115610a7f576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610a7690612361565b60405180910390fd5b6000610a8b6007610aaf565b9050610a976007610abd565b610aa1338261125b565b610aab8183611478565b5050565b600081600001549050919050565b6001816000016000828254019250508190555050565b60007f01ffc9a7000000000000000000000000000000000000000000000000000000007bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916827bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916149050919050565b610b46816114e5565b610b85576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610b7c90612203565b60405180910390fd5b50565b600033905090565b816004600083815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550808273ffffffffffffffffffffffffffffffffffffffff16610c0383610644565b73ffffffffffffffffffffffffffffffffffffffff167f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b92560405160405180910390a45050565b600080610c5583610644565b90508073ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff161480610c975750610c96818561099d565b5b80610cd557508373ffffffffffffffffffffffffffffffffffffffff16610cbd84610467565b73ffffffffffffffffffffffffffffffffffffffff16145b91505092915050565b8273ffffffffffffffffffffffffffffffffffffffff16610cfe82610644565b73ffffffffffffffffffffffffffffffffffffffff1614610d54576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610d4b906123f3565b60405180910390fd5b600073ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff1603610dc3576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610dba90612485565b60405180910390fd5b610dd08383836001611526565b8273ffffffffffffffffffffffffffffffffffffffff16610df082610644565b73ffffffffffffffffffffffffffffffffffffffff1614610e46576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610e3d906123f3565b60405180910390fd5b6004600082815260200190815260200160002060006101000a81549073ffffffffffffffffffffffffffffffffffffffff02191690556001600360008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082825403925050819055506001600360008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008282540192505081905550816002600083815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550808273ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef60405160405180910390a4610fd2838383600161152c565b505050565b60006002600083815260200190815260200160002060009054906101000a900473ffffffffffffffffffffffffffffffffffffffff169050919050565b8173ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff1603611082576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401611079906124f1565b60405180910390fd5b80600560008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060006101000a81548160ff0219169083151502179055508173ffffffffffffffffffffffffffffffffffffffff168373ffffffffffffffffffffffffffffffffffffffff167f17307eab39ab6107e8899845ad3d59bd9653f200f220920489ca2b5937696c318360405161117391906119b1565b60405180910390a3505050565b61118b848484610cde565b61119784848484611532565b6111d6576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016111cd90612583565b60405180910390fd5b50505050565b606060405180602001604052806000815250905090565b60606111fe82610b3d565b60006112086111dc565b905060008151116112285760405180602001604052806000815250611253565b80611232846116b9565b6040516020016112439291906122f1565b6040516020818303038152906040525b915050919050565b600073ffffffffffffffffffffffffffffffffffffffff168273ffffffffffffffffffffffffffffffffffffffff16036112ca576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016112c1906125ef565b60405180910390fd5b6112d3816114e5565b15611313576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161130a9061265b565b60405180910390fd5b611321600083836001611526565b61132a816114e5565b1561136a576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016113619061265b565b60405180910390fd5b6001600360008473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008282540192505081905550816002600083815260200190815260200160002060006101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff160217905550808273ffffffffffffffffffffffffffffffffffffffff16600073ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef60405160405180910390a461147460008383600161152c565b5050565b611481826114e5565b6114c0576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016114b7906126ed565b60405180910390fd5b806006600084815260200190815260200160002090816114e091906128b9565b505050565b60008073ffffffffffffffffffffffffffffffffffffffff1661150783610fd7565b73ffffffffffffffffffffffffffffffffffffffff1614159050919050565b50505050565b50505050565b60006115538473ffffffffffffffffffffffffffffffffffffffff16611787565b156116ac578373ffffffffffffffffffffffffffffffffffffffff1663150b7a0261157c610b88565b8786866040518563ffffffff1660e01b815260040161159e94939291906129e0565b6020604051808303816000875af19250505080156115da57506040513d601f19601f820116820180604052508101906115d79190612a41565b60015b61165c573d806000811461160a576040519150601f19603f3d011682016040523d82523d6000602084013e61160f565b606091505b506000815103611654576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161164b90612583565b60405180910390fd5b805181602001fd5b63150b7a0260e01b7bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916817bffffffffffffffffffffffffffffffffffffffffffffffffffffffff1916149150506116b1565b600190505b949350505050565b6060600060016116c8846117aa565b01905060008167ffffffffffffffff8111156116e7576116e6611cc9565b5b6040519080825280601f01601f1916602001820160405280156117195781602001600182028036833780820191505090505b509050600082602001820190505b60011561177c578080600190039150507f3031323334353637383961626364656600000000000000000000000000000000600a86061a8153600a85816117705761176f612a6e565b5b04945060008503611727575b819350505050919050565b6000808273ffffffffffffffffffffffffffffffffffffffff163b119050919050565b600080600090507a184f03e93ff9f4daa797ed6e38ed64bf6a1f0100000000000000008310611808577a184f03e93ff9f4daa797ed6e38ed64bf6a1f01000000000000000083816117fe576117fd612a6e565b5b0492506040810190505b6d04ee2d6d415b85acef81000000008310611845576d04ee2d6d415b85acef8100000000838161183b5761183a612a6e565b5b0492506020810190505b662386f26fc10000831061187457662386f26fc10000838161186a57611869612a6e565b5b0492506010810190505b6305f5e100831061189d576305f5e100838161189357611892612a6e565b5b0492506008810190505b61271083106118c25761271083816118b8576118b7612a6e565b5b0492506004810190505b606483106118e557606483816118db576118da612a6e565b5b0492506002810190505b600a83106118f4576001810190505b80915050919050565b6000604051905090565b600080fd5b600080fd5b60007fffffffff0000000000000000000000000000000000000000000000000000000082169050919050565b61194681611911565b811461195157600080fd5b50565b6000813590506119638161193d565b92915050565b60006020828403121561197f5761197e611907565b5b600061198d84828501611954565b91505092915050565b60008115159050919050565b6119ab81611996565b82525050565b60006020820190506119c660008301846119a2565b92915050565b600081519050919050565b600082825260208201905092915050565b60005b83811015611a065780820151818401526020810190506119eb565b60008484015250505050565b6000601f19601f8301169050919050565b6000611a2e826119cc565b611a3881856119d7565b9350611a488185602086016119e8565b611a5181611a12565b840191505092915050565b60006020820190508181036000830152611a768184611a23565b905092915050565b6000819050919050565b611a9181611a7e565b8114611a9c57600080fd5b50565b600081359050611aae81611a88565b92915050565b600060208284031215611aca57611ac9611907565b5b6000611ad884828501611a9f565b91505092915050565b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b6000611b0c82611ae1565b9050919050565b611b1c81611b01565b82525050565b6000602082019050611b376000830184611b13565b92915050565b611b4681611b01565b8114611b5157600080fd5b50565b600081359050611b6381611b3d565b92915050565b60008060408385031215611b8057611b7f611907565b5b6000611b8e85828601611b54565b9250506020611b9f85828601611a9f565b9150509250929050565b600080600060608486031215611bc257611bc1611907565b5b6000611bd086828701611b54565b9350506020611be186828701611b54565b9250506040611bf286828701611a9f565b9150509250925092565b600060208284031215611c1257611c11611907565b5b6000611c2084828501611b54565b91505092915050565b611c3281611a7e565b82525050565b6000602082019050611c4d6000830184611c29565b92915050565b611c5c81611996565b8114611c6757600080fd5b50565b600081359050611c7981611c53565b92915050565b60008060408385031215611c9657611c95611907565b5b6000611ca485828601611b54565b9250506020611cb585828601611c6a565b9150509250929050565b600080fd5b600080fd5b7f4e487b7100000000000000000000000000000000000000000000000000000000600052604160045260246000fd5b611d0182611a12565b810181811067ffffffffffffffff82111715611d2057611d1f611cc9565b5b80604052505050565b6000611d336118fd565b9050611d3f8282611cf8565b919050565b600067ffffffffffffffff821115611d5f57611d5e611cc9565b5b611d6882611a12565b9050602081019050919050565b82818337600083830152505050565b6000611d97611d9284611d44565b611d29565b905082815260208101848484011115611db357611db2611cc4565b5b611dbe848285611d75565b509392505050565b600082601f830112611ddb57611dda611cbf565b5b8135611deb848260208601611d84565b91505092915050565b60008060008060808587031215611e0e57611e0d611907565b5b6000611e1c87828801611b54565b9450506020611e2d87828801611b54565b9350506040611e3e87828801611a9f565b925050606085013567ffffffffffffffff811115611e5f57611e5e61190c565b5b611e6b87828801611dc6565b91505092959194509250565b60008060408385031215611e8e57611e8d611907565b5b6000611e9c85828601611b54565b9250506020611ead85828601611b54565b9150509250929050565b600067ffffffffffffffff821115611ed257611ed1611cc9565b5b611edb82611a12565b9050602081019050919050565b6000611efb611ef684611eb7565b611d29565b905082815260208101848484011115611f1757611f16611cc4565b5b611f22848285611d75565b509392505050565b600082601f830112611f3f57611f3e611cbf565b5b8135611f4f848260208601611ee8565b91505092915050565b600060208284031215611f6e57611f6d611907565b5b600082013567ffffffffffffffff811115611f8c57611f8b61190c565b5b611f9884828501611f2a565b91505092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052602260045260246000fd5b60006002820490506001821680611fe857607f821691505b602082108103611ffb57611ffa611fa1565b5b50919050565b7f4552433732313a20617070726f76616c20746f2063757272656e74206f776e6560008201527f7200000000000000000000000000000000000000000000000000000000000000602082015250565b600061205d6021836119d7565b915061206882612001565b604082019050919050565b6000602082019050818103600083015261208c81612050565b9050919050565b7f4552433732313a20617070726f76652063616c6c6572206973206e6f7420746f60008201527f6b656e206f776e6572206f7220617070726f76656420666f7220616c6c000000602082015250565b60006120ef603d836119d7565b91506120fa82612093565b604082019050919050565b6000602082019050818103600083015261211e816120e2565b9050919050565b7f4552433732313a2063616c6c6572206973206e6f7420746f6b656e206f776e6560008201527f72206f7220617070726f76656400000000000000000000000000000000000000602082015250565b6000612181602d836119d7565b915061218c82612125565b604082019050919050565b600060208201905081810360008301526121b081612174565b9050919050565b7f4552433732313a20696e76616c696420746f6b656e2049440000000000000000600082015250565b60006121ed6018836119d7565b91506121f8826121b7565b602082019050919050565b6000602082019050818103600083015261221c816121e0565b9050919050565b7f4552433732313a2061646472657373207a65726f206973206e6f74206120766160008201527f6c6964206f776e65720000000000000000000000000000000000000000000000602082015250565b600061227f6029836119d7565b915061228a82612223565b604082019050919050565b600060208201905081810360008301526122ae81612272565b9050919050565b600081905092915050565b60006122cb826119cc565b6122d581856122b5565b93506122e58185602086016119e8565b80840191505092915050565b60006122fd82856122c0565b915061230982846122c0565b91508190509392505050565b7f4d6178204e4654206d696e74696e67206c696d69742072656163686564202121600082015250565b600061234b6020836119d7565b915061235682612315565b602082019050919050565b6000602082019050818103600083015261237a8161233e565b9050919050565b7f4552433732313a207472616e736665722066726f6d20696e636f72726563742060008201527f6f776e6572000000000000000000000000000000000000000000000000000000602082015250565b60006123dd6025836119d7565b91506123e882612381565b604082019050919050565b6000602082019050818103600083015261240c816123d0565b9050919050565b7f4552433732313a207472616e7366657220746f20746865207a65726f2061646460008201527f7265737300000000000000000000000000000000000000000000000000000000602082015250565b600061246f6024836119d7565b915061247a82612413565b604082019050919050565b6000602082019050818103600083015261249e81612462565b9050919050565b7f4552433732313a20617070726f766520746f2063616c6c657200000000000000600082015250565b60006124db6019836119d7565b91506124e6826124a5565b602082019050919050565b6000602082019050818103600083015261250a816124ce565b9050919050565b7f4552433732313a207472616e7366657220746f206e6f6e20455243373231526560008201527f63656976657220696d706c656d656e7465720000000000000000000000000000602082015250565b600061256d6032836119d7565b915061257882612511565b604082019050919050565b6000602082019050818103600083015261259c81612560565b9050919050565b7f4552433732313a206d696e7420746f20746865207a65726f2061646472657373600082015250565b60006125d96020836119d7565b91506125e4826125a3565b602082019050919050565b60006020820190508181036000830152612608816125cc565b9050919050565b7f4552433732313a20746f6b656e20616c7265616479206d696e74656400000000600082015250565b6000612645601c836119d7565b91506126508261260f565b602082019050919050565b6000602082019050818103600083015261267481612638565b9050919050565b7f45524337323155524953746f726167653a2055524920736574206f66206e6f6e60008201527f6578697374656e7420746f6b656e000000000000000000000000000000000000602082015250565b60006126d7602e836119d7565b91506126e28261267b565b604082019050919050565b60006020820190508181036000830152612706816126ca565b9050919050565b60008190508160005260206000209050919050565b60006020601f8301049050919050565b600082821b905092915050565b60006008830261276f7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff82612732565b6127798683612732565b95508019841693508086168417925050509392505050565b6000819050919050565b60006127b66127b16127ac84611a7e565b612791565b611a7e565b9050919050565b6000819050919050565b6127d08361279b565b6127e46127dc826127bd565b84845461273f565b825550505050565b600090565b6127f96127ec565b6128048184846127c7565b505050565b5b818110156128285761281d6000826127f1565b60018101905061280a565b5050565b601f82111561286d5761283e8161270d565b61284784612722565b81016020851015612856578190505b61286a61286285612722565b830182612809565b50505b505050565b600082821c905092915050565b600061289060001984600802612872565b1980831691505092915050565b60006128a9838361287f565b9150826002028217905092915050565b6128c2826119cc565b67ffffffffffffffff8111156128db576128da611cc9565b5b6128e58254611fd0565b6128f082828561282c565b600060209050601f8311600181146129235760008415612911578287015190505b61291b858261289d565b865550612983565b601f1984166129318661270d565b60005b8281101561295957848901518255600182019150602085019450602081019050612934565b868310156129765784890151612972601f89168261287f565b8355505b6001600288020188555050505b505050505050565b600081519050919050565b600082825260208201905092915050565b60006129b28261298b565b6129bc8185612996565b93506129cc8185602086016119e8565b6129d581611a12565b840191505092915050565b60006080820190506129f56000830187611b13565b612a026020830186611b13565b612a0f6040830185611c29565b8181036060830152612a2181846129a7565b905095945050505050565b600081519050612a3b8161193d565b92915050565b600060208284031215612a5757612a56611907565b5b6000612a6584828501612a2c565b91505092915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601260045260246000fdfea2646970667358221220f72224dfefad7c5e1eea16f0775cfb0396c5de5e86f70133e26001952f9c933464736f6c6343000812003368747470733a2f2f697066732e696f2f697066732f516d584e6e41486a63377a3567627064556b4a58354d753269517a354772474c6a667238486b46696e5a4c6a7153"

const ABI = [
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "name",
				"type": "string"
			},
			{
				"internalType": "string",
				"name": "symbol",
				"type": "string"
			}
		],
		"stateMutability": "nonpayable",
		"type": "constructor"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"internalType": "address",
				"name": "owner",
				"type": "address"
			},
			{
				"indexed": true,
				"internalType": "address",
				"name": "approved",
				"type": "address"
			},
			{
				"indexed": true,
				"internalType": "uint256",
				"name": "tokenId",
				"type": "uint256"
			}
		],
		"name": "Approval",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"internalType": "address",
				"name": "owner",
				"type": "address"
			},
			{
				"indexed": true,
				"internalType": "address",
				"name": "operator",
				"type": "address"
			},
			{
				"indexed": false,
				"internalType": "bool",
				"name": "approved",
				"type": "bool"
			}
		],
		"name": "ApprovalForAll",
		"type": "event"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "to",
				"type": "address"
			},
			{
				"internalType": "uint256",
				"name": "tokenId",
				"type": "uint256"
			}
		],
		"name": "approve",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "string",
				"name": "tokenURI",
				"type": "string"
			}
		],
		"name": "mintNFT",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "from",
				"type": "address"
			},
			{
				"internalType": "address",
				"name": "to",
				"type": "address"
			},
			{
				"internalType": "uint256",
				"name": "tokenId",
				"type": "uint256"
			}
		],
		"name": "safeTransferFrom",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "from",
				"type": "address"
			},
			{
				"internalType": "address",
				"name": "to",
				"type": "address"
			},
			{
				"internalType": "uint256",
				"name": "tokenId",
				"type": "uint256"
			},
			{
				"internalType": "bytes",
				"name": "data",
				"type": "bytes"
			}
		],
		"name": "safeTransferFrom",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "operator",
				"type": "address"
			},
			{
				"internalType": "bool",
				"name": "approved",
				"type": "bool"
			}
		],
		"name": "setApprovalForAll",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": true,
				"internalType": "address",
				"name": "from",
				"type": "address"
			},
			{
				"indexed": true,
				"internalType": "address",
				"name": "to",
				"type": "address"
			},
			{
				"indexed": true,
				"internalType": "uint256",
				"name": "tokenId",
				"type": "uint256"
			}
		],
		"name": "Transfer",
		"type": "event"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "from",
				"type": "address"
			},
			{
				"internalType": "address",
				"name": "to",
				"type": "address"
			},
			{
				"internalType": "uint256",
				"name": "tokenId",
				"type": "uint256"
			}
		],
		"name": "transferFrom",
		"outputs": [],
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "owner",
				"type": "address"
			}
		],
		"name": "balanceOf",
		"outputs": [
			{
				"internalType": "uint256",
				"name": "",
				"type": "uint256"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "tokenId",
				"type": "uint256"
			}
		],
		"name": "getApproved",
		"outputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "address",
				"name": "owner",
				"type": "address"
			},
			{
				"internalType": "address",
				"name": "operator",
				"type": "address"
			}
		],
		"name": "isApprovedForAll",
		"outputs": [
			{
				"internalType": "bool",
				"name": "",
				"type": "bool"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "name",
		"outputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "tokenId",
				"type": "uint256"
			}
		],
		"name": "ownerOf",
		"outputs": [
			{
				"internalType": "address",
				"name": "",
				"type": "address"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "bytes4",
				"name": "interfaceId",
				"type": "bytes4"
			}
		],
		"name": "supportsInterface",
		"outputs": [
			{
				"internalType": "bool",
				"name": "",
				"type": "bool"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [],
		"name": "symbol",
		"outputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"stateMutability": "view",
		"type": "function"
	},
	{
		"inputs": [
			{
				"internalType": "uint256",
				"name": "tokenId",
				"type": "uint256"
			}
		],
		"name": "tokenURI",
		"outputs": [
			{
				"internalType": "string",
				"name": "",
				"type": "string"
			}
		],
		"stateMutability": "view",
		"type": "function"
	}
]

  function getCsrfToken() {
    const csrfCookie = document.cookie.split(';').find(cookie => cookie.trim().startsWith('csrftoken='));
    if (!csrfCookie) {
      return null;
    }
    return csrfCookie.split('=')[1];
  }

function save_collection(name,symbol,contract_address) 
{
    var csrftoken = getCsrfToken()
    const form = document.querySelector('#collection-form');
    const formData = new FormData();
    formData.append('name', name);
    formData.append('symbol', symbol);
    formData.append('contract_address', contract_address);
    formData.append('logo', form.elements.collection_img.files[0]);

    $.ajax({
      type: 'POST',
      url: '/profile/',
      headers: {'X-CSRFToken': csrftoken},
      data: formData,
      processData: false,
      contentType: false,
      success: function(data) {
        loader.style.display = 'none';
        window.alert(`Contract deployed at address ${contract_address}`);
        console.log('NFT collection saved successfully!');
        location.reload()
      },
      error: function(xhr, textStatus, errorThrown) {
        console.log('Error saving NFT collection:', errorThrown);
        location.reload()
      }
    });
}

const create_collection = async()  => {
        // Get the user's Ethereum address from MetaMask
        const loader = document.getElementById('loader');
        const body = document.getElementsByTagName('body')[0];
        const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
        const fromAddress = accounts[0];
        const web3 = new Web3(window.ethereum);
        const userNFTContract = new web3.eth.Contract(ABI);
        const name = document.getElementById('collection_name').value
        const symbol = document.getElementById('collection_symbol').value


        if (name === '')
            window.alert('Name is a required field...')
        else if (symbol === '')
            window.alert('Symbol is a required field...')
        else
        {
            loader.style.display = 'block';
            const deployed = await userNFTContract.deploy({ data: bytecode,
            arguments: [name, symbol],})
            .send({ from:fromAddress})
            .on('error', (error) => {window.alert(error.message)
                loader.style.display = 'none';})
            .on('transactionHash', (transactionHash) => console.log(`Transaction hash: ${transactionHash}`))
            .on('receipt', (receipt) => console.log(`Contract address: ${receipt.contractAddress}`))
            .then((newContractInstance) => {
                const contract_address = newContractInstance.options.address
                console.log(`Contract deployed: ${contract_address}`)
                save_collection(name,symbol,contract_address)
            });
        }
};